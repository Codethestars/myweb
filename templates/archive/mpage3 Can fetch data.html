<!DOCTYPE html>
<html>
<!-- [Previous HTML and CSS remain exactly the same until the script section] -->
<head>
    <title>Minimum Ventilation Rates in Breathing Zone</title>
    <!-- [Previous styles remain the same] -->
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Engineer's Toolbox</h1>
        </div>

        <div class="breadcrumb">
            <a href="{{ url_for('index') }}">Home</a>
            <span>/</span>
            <a href="{{ url_for('landing') }}">Mechanical Menu</a>
            <span>/</span>
            <a href="#">Minimum Ventilation Rates</a>
        </div>
        
        <div class="content">
            <h2 class="page-title">Minimum Ventilation Rates in Breathing Zone</h2>
            <div class="menu-container">
                <div class="combobox-container">
                    <label class="combobox-label">Occupancy Category:</label>
                    <select id="occupancyCategory" onchange="updateOccupancyDetails()">
                        <option value="">Select Occupancy Category</option>
                    </select>
                </div>
                
                <div class="combobox-container">
                    <label class="combobox-label">People Outdoor Air Rate:</label>
                    <select id="peopleOutdoorAirRates" disabled>
                        <option value="">Select Rate</option>
                    </select>
                </div>
                
                <div class="combobox-container">
                    <label class="combobox-label">Area Outdoor Air Rate:</label>
                    <select id="areaOutdoorAirRates" disabled>
                        <option value="">Select Rate</option>
                    </select>
                </div>
                
                <div class="combobox-container">
                    <label class="combobox-label">Default Occupant Density:</label>
                    <select id="defaultOccDensity" disabled>
                        <option value="">Select Density</option>
                    </select>
                </div>
                
                <div class="combobox-container">
                    <label class="combobox-label">Air Class:</label>
                    <select id="airClass" disabled>
                        <option value="">Select Air Class</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Engineer's Toolbox Â© 2024</p>
        </div>
    </div>
    
    <script>
        let fullData = [];

        fetch('/get_data_page3')
            .then(response => response.json())
            .then(data => {
                fullData = data;
                const occupancySelect = document.getElementById('occupancyCategory');
                const categories = [...new Set(data.map(item => item["OCCUPANCY CATEGORY"]))].sort();
                
                occupancySelect.innerHTML = '<option value="">Select Occupancy Category</option>';
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    occupancySelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error:', error));

        function updateOccupancyDetails() {
            const selectedCategory = document.getElementById('occupancyCategory').value;
            const matchingRow = fullData.find(item => item["OCCUPANCY CATEGORY"] === selectedCategory);
            
            if (matchingRow) {
                document.getElementById('peopleOutdoorAirRates').innerHTML = 
                    `<option>${matchingRow["PEOPLE OUTDOOR Air Rate Rp (CFM/person)"]}</option>`;
                document.getElementById('areaOutdoorAirRates').innerHTML = 
                    `<option>${matchingRow["AREA OUTDOOR Air Rate Ra (CFM/sq ft)"]}</option>`;
                document.getElementById('defaultOccDensity').innerHTML = 
                    `<option>${matchingRow["DEFAULT OCCUPANT DENSITY3 (people/1000 sq ft)"]}</option>`;
                document.getElementById('airClass').innerHTML = 
                    `<option>${matchingRow["AIR CLASS"]}</option>`;
            }
        }
    </script>
</body>
</html>