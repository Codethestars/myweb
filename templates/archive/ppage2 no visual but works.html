<!DOCTYPE html>
<html>
<head>
    <title>Pipe Size Data</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <div class="header">
        <h1>Plumbing Pipe Size and Valve Data</h1>
    </div>
    
    <div class="container">
        <div class="content">
            <div class="combobox-container">
                <label class="combobox-label">Nominal Pipe Size:</label>
                <select id="pipeSize" onchange="updatePipeDetails()">
                    <option value="">Select Pipe Size</option>
                </select>
            </div>
            
            <div class="combobox-container">
                <label class="combobox-label">Gate Valve Full Open:</label>
                <select id="gateValve" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>
            
            <div class="combobox-container">
                <label class="combobox-label">Angle Valve Full Open:</label>
                <select id="angleValve" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>
            
            <div class="combobox-container">
                <label class="combobox-label">Globe Valve Full Open:</label>
                <select id="globeValve" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>
            
            <div class="combobox-container">
                <label class="combobox-label">Swing Check Valve Full Open:</label>
                <select id="swingCheckValve" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>

            <div class="combobox-container">
                <label class="combobox-label">45 Degree Elbow:</label>
                <select id="elbow45" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>

            <div class="combobox-container">
                <label class="combobox-label">Long Sweep Elbow or Run of Tee:</label>
                <select id="longSweepElbow" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>

            <div class="combobox-container">
                <label class="combobox-label">Standard Elbow:</label>
                <select id="standardElbow" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>

            <div class="combobox-container">
                <label class="combobox-label">Standard Tee Through Side Outlet:</label>
                <select id="standardTee" disabled readonly>
                    <option value="">Select Value</option>
                </select>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2024 Plumbing Pipe Data</p>
    </div>

    <script>
        let fullData = [];

        // Fetch data from ppage2.txt
        fetch('/get_data_ppage2')
            .then(response => response.json())
            .then(data => {
                fullData = data;
                
                // Populate the Nominal Pipe Size dropdown with unique values
                const pipeSizeSelect = document.getElementById('pipeSize');
                const pipeSizes = [...new Set(data.map(item => item["NOMINAL PIPE SIZE"]))];
                pipeSizes.forEach(size => {
                    const option = document.createElement('option');
                    option.value = size;
                    option.textContent = size;
                    pipeSizeSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error:', error));

        function updatePipeDetails() {
            const selectedSize = document.getElementById('pipeSize').value;
            const matchingRow = fullData.find(item => item["NOMINAL PIPE SIZE"] === selectedSize);

            if (matchingRow) {
                // Populate each field based on the selected pipe size
                document.getElementById('gateValve').innerHTML = `<option>${matchingRow["GATE VALVE FULL OPEN"]}</option>`;
                document.getElementById('angleValve').innerHTML = `<option>${matchingRow["ANGLE VALVE FULL OPEN"]}</option>`;
                document.getElementById('globeValve').innerHTML = `<option>${matchingRow["GLOBE VALL FULL OPEN"]}</option>`;
                document.getElementById('swingCheckValve').innerHTML = `<option>${matchingRow["SWING CHECK VALVE FULL OPEN"]}</option>`;
                document.getElementById('elbow45').innerHTML = `<option>${matchingRow["45 DEG ELBOW"]}</option>`;
                document.getElementById('longSweepElbow').innerHTML = `<option>${matchingRow["LONG SWEEP ELBOW OR RUN OF TEE"]}</option>`;
                document.getElementById('standardElbow').innerHTML = `<option>${matchingRow["STANDARD ELBOW"]}</option>`;
                document.getElementById('standardTee').innerHTML = `<option>${matchingRow["STANDARD TEE THRU SIDE OUTLET"]}</option>`;
            }
        }
    </script>
</body>
</html>
